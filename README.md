# RADD


Notes:
- Sockeye: accessible by Afraz + Lisa
- ComputeCanada: accessible by Lisa
 
## One time setup 

1. Apply for Sockeye allocation: https://flex.redcap.ubc.ca/surveys/?s=7MKJT898LK
2. Setup [Multi-factor authentication](https://mfadevices.id.ubc.ca/). This is mandatory step or you will not be able to SSH.
3. Install myVPN:
   - [Set up guide for Mac users](https://ubc.service-now.com/kb_view.do?sysparm_article=KB0017956#macos)
   - Window users may need to email and request OneDrive link to download an installer, as Lisa did in April, 2024


## One time setup 

1. Connect to ```myvpn.ubc.ca``` through myVPN app
 
2. Connect to to Sockey through terminal using Secure Socket Shell protocol (SSH):
```
ssh username@sockeye.arc.ubc.ca
```

3. Navigate to project folder:
```
cd /arc/project/st-username-1/RADD
```

## Running part 1

1. Interactively

   - Use apptainer prepared by Chris [see logs](https://github.com/BCCDC-DSI/RADD/blob/main/workflows/part1/log.md)
 
    [See slide 7](https://docs.google.com/presentation/d/1EoPfQdC32cnRHPE95FKA8puVm2C3zmvNykvNYOYzaO8/edit#slide=id.g2e0ef6ef4e5_0_648)

    If this runs and produces the following output:

    <details>
          
     ```
     Detecting mass traces at 25 ppm ... OK
     Detecting chromatographic peaks in 41125 regions of interest ... OK: 9122 found.
     
     [1/83] 2-Fluorodeschloroketamine ...
     [2/83] 2-Methyl AP-237 ...
     [3/83] 3,4-Difluoro-U-47700 ...
     [4/83] 3-Hydroxyphenazepam ...
     [5/83] 4-Trifluoromethyl-U-47700 ...
     [6/83] 4F-ABINACA ...
     [7/83] 4F-Ethylphenidate ...
     [8/83] 4F-MDMB-BICA ...
     [9/83] 5-Methoxy MiPT ...
     [10/83] 5F-CUMYL-PINACA ...
     [11/83] 5F-EDMB-PICA ...
     [12/83] 5F-EMB-PICA ...
     [13/83] 5F-MDMB PICA ...
     [14/83] 8-Aminoclonazolam ...
     [15/83] AB-FUBINACA ...
     [16/83] ADB-4en-PINACA ...
     [17/83] ADB-BINACA ...
     [18/83] ADB-FUBIATA ...
     [19/83] ADB-HEXINACA ...
     [20/83] ADB-PHENITACA ...
     [21/83] Adinazolam ...
     [22/83] Alpha-PCYP ...
     [23/83] Alpha-PiHP ...
     [24/83] AP-237 ...
     [25/83] AP-238 ...
     [26/83] Benocyclidine ...
     [27/83] Bentazepam ...
     [28/83] Bromazolam ...
     [29/83] Bromofentanyl ...
     [30/83] Brorphine ...
     [31/83] Brotizolam ...
     [32/83] Butonitazene ...
     [33/83] BZO-HEXOXIZID ...
     [34/83] Chlorofentanyl ...
     [35/83] Ciclotizolam ...
     [36/83] Cl-PCP ...
     [37/83] Clonazolam ...
     [38/83] Clotiazepam ...
     [39/83] Delorazepam ...
     [40/83] Desalkylgidazepam ...
     [41/83] Deschloroetizolam ...
     [42/83] Diclazepam ...
     [43/83] Dipyanone ...
     [44/83] EDMB-PINACA ...
     [45/83] Estazolam ...
     [46/83] Etaqualone ...
     [47/83] Etodesnitazene ...
     [48/83] Etonitazene ...
     [49/83] Eutylone ...
     [50/83] F-PCP ...
     [51/83] Flubromazepam ...
     [52/83] Flubromazolam ...
     [53/83] Fluclotizolam ...
     [54/83] Flunitazene ...
     [55/83] Fluorofentanyl ...
     [56/83] FUB-144 ...
     [57/83] Furanyl UF-17 ...
     [58/83] Gidazepam ...
     [59/83] Loprazolam ...
     [60/83] Lormetazepam ...
     [61/83] MDMB-4en-BINACA ...
     [62/83] MDMB-5Br-INACA ...
     [63/83] Meclonazepam ...
     [64/83] MeO-PCE ...
     [65/83] Methoxpropamine ...
     [66/83] Methylenedioxy-PV8 ...
     [67/83] Metizolam ...
     [68/83] Metonitazene ...
     [69/83] N,N-Dimethylpentylone ...
     [70/83] N-Ethyl-U-47700 ...
     [71/83] N-Ethylpentedrone ...
     [72/83] N-methyl-U-47931E ...
     [73/83] N-Methylhexylone ...
     [74/83] n-Piperidinyl etonitazene ...
     [75/83] N-Pyrrolidino Etonitazene ...
     [76/83] Napthyl-U-47700 ...
     [77/83] Nitrazolam ...
     [78/83] para-Methyl AP-237 ...
     [79/83] Phenazepam ...
     [80/83] Pyrazolam ...
     [81/83] Tenocyclidine ...
     [82/83] U-47931E ...
     [83/83] Zapizolam ...
     [1] "writing to /scratch/st-cfjell-1/output/ms_data/expedited_2023//2023-0001BG01.rds"
     ```
    
     The script is working perfectly fine and you can run all the tests.
     
     </details>

2. Submit as a batch array of jobs: see [how-to notes](https://github.com/BCCDC-DSI/RADD/issues/36) 

3. Reformat ```.rds``` to ```.csv``` using R script
  - ```rds_to_csv.R```

 <details>
 
 <summary>Archive</summary>
  
 3a. Reformat RDS to .csv / .xlsx using Python script
 - ```rds_to_csv.py```
 
 </details>
 
## Part 2 

[Pending] 

## Part 3

Source: https://github.com/skinnider/NPS-generation

[Pending]
 
